<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Principio di Sovrapposizione Interattivo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Stile di base per il corpo e il layout responsivo */
        body {
            color: #1a202c;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background-color: #ffffff;
        }

        h1 {
            text-align: center;
            color: #2b6cb0;
            margin-bottom: 20px;
            font-weight: 700;
        }

        /* Stile per i pannelli delle onde (Canvas) */
        .wave-panel {
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .wave-panel h2 {
            font-size: 1.25rem;
            padding: 10px 15px;
            margin: 0;
            background-color: #f7fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        canvas {
            display: block;
            width: 100%;
            height: 400px; /* Altezza fissa per coerenza */
            background-color: #ffffff;
        }

        /* Colore specifico per l'onda risultante */
        #canvas-sum {
            background-color: #ebf8ff;
        }

        /* Stile per i controlli (Slider) */
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding-top: 10px;
        }

        .control-group {
            background-color: #ffffff;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
        }

        /* Modifica chiave: Rendi flessibile la label e centra gli item */
        .control-group label {
            /* display: block; -- Rimosso per usare flex */
            display: flex; /* Abilita flexbox per allineamento orizzontale */
            align-items: center; /* Allinea verticalmente (centra) gli elementi */
            justify-content: space-between; /* Spinge gli elementi ai lati (nome slider a sinistra, valore a destra) */
            margin-bottom: 15px; /* Aumenta lo spazio tra gli slider */
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
        }

        /* Stile per il contenitore dell'input per forzare l'allineamento */
        .slider-container {
            display: flex;
            flex-grow: 1; /* Permette al contenitore di occupare lo spazio disponibile */
            align-items: center;
            margin-right: 10px; /* Spazio tra lo slider e il valore */
        }

        input[type="range"] {
            width: 100%; /* L'input occupa lo spazio del contenitore flessibile */
            margin: 0; /* Rimuovi i margini verticali predefiniti */
            -webkit-appearance: none;
            height: 4px;
            background: #444;
            border-radius: 5px;
        }

        /* Stile per l'output numerico dello slider */
        .slider-value {
            font-weight: 700;
            color: #2b6cb0;
            /* margin-left: 10px; -- Rimosso, lo spazio è gestito dal flex container */
            width: 40px; /* Larghezza fissa per mantenere l'allineamento dei valori */
            text-align: right;
        }

        /* Stili specifici per raggruppare i controlli delle due onde */
        .wave-1-controls { border-color: #90cdf4; }
        .wave-2-controls { border-color: #fbd38d; }

    </style>
</head>
<body>

<div class="container">
    <!-- Controlli Slider -->
    <div class="controls-grid">
        <div class="control-group wave-1-controls">
            <h3 style="color: #3182ce; margin-top: 0; border-bottom: 1px solid #bee3f8; padding-bottom: 5px;">Parametri dell’onda</h3>

            <!-- Etichetta Ampiezza (A) -->
            <label>
                Ampiezza (A):
                <div class="slider-container">
                    <input type="range" id="amplitude1" min="10" max="300" value="200" step="1" oninput="drawAll()">
                </div>
                <span id="val-a1" class="slider-value"></span>
            </label>

            <!-- Etichetta Frequenza (F) -->
            <label>
                Frequenza (F):
                <div class="slider-container">
                    <input type="range" id="frequency1" min="1" max="10" value="2" step="0.1" oninput="drawAll()">
                </div>
                <span id="val-f1" class="slider-value"></span>
            </label>

            <!-- Etichetta Sfasamento -->
            <label>
                Sfasamento:
                <div class="slider-container">
                    <input type="range" id="phase1" min="0" max="360" value="0" step="10" oninput="drawAll()">
                </div>
                <span id="val-p1" class="slider-value"></span>
            </label>
        </div>
    </div>

    <!-- Pannelli di Visualizzazione Canvas -->

    <div class="wave-panel">
        <h2 style="color: #3182ce;">Visualizzazione della pressione dell’onda nel tempo</h2>
        <canvas id="canvas-1" width="900" height="600"></canvas>
    </div>

</div>

<script>
    // Inizializzazione delle costanti e dei contesti
    const CANVAS_WIDTH = 900;
    const CANVAS_HEIGHT = 600;
    const CENTER_Y = CANVAS_HEIGHT / 2;
    const STEP_X = 1;
    const PI = Math.PI;

    // Ottiene i context dei tre canvas
    const ctx1 = document.getElementById('canvas-1').getContext('2d');

    // Funzione per disegnare la linea di base (asse X)
    function drawAxis(ctx) {
        ctx.strokeStyle = '#a0aec0'; // Colore grigio
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(0, CENTER_Y);
        ctx.lineTo(CANVAS_WIDTH, CENTER_Y);
        ctx.stroke();
    }

    /**
     * Disegna un'onda sinusoidale su un canvas.
     * @param {CanvasRenderingContext2D} ctx - Contesto del canvas.
     * @param {number} amplitude - Ampiezza dell'onda.
     * @param {number} frequency - Frequenza (numero di cicli sull'asse X).
     * @param {number} phase - Fase in radianti.
     * @param {string} color - Colore della linea.
     */
    function drawWave(ctx, amplitude, frequency, phase, color) {
        drawAxis(ctx); // Disegna l'asse prima dell'onda

        f = function(x) {
            return amplitude * Math.sin(2 * PI * frequency * x * 4 + phase);
        }

        ctx.strokeStyle = color;
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(0, CENTER_Y - f(0));

        // La formula base dell'onda è: A * sin(2 * PI * F * x_normalizzato + Φ)
        for (let x = STEP_X; x <= CANVAS_WIDTH; x += STEP_X) {
            // Normalizza x tra 0 e 1.0
            const xNormalized = x / CANVAS_WIDTH;

            // Calcolo del valore Y dell'onda
            const y = f(xNormalized);

            // Disegna il punto traslato sul canvas
            ctx.lineTo(x, CENTER_Y - y);
        }
        ctx.stroke();
    }

    /**
     * Funzione principale per leggere i valori e ridisegnare tutto.
     */
    function drawAll() {
        // 1. Legge i valori degli slider
        const A1 = parseFloat(document.getElementById('amplitude1').value);
        const F1 = parseFloat(document.getElementById('frequency1').value);
        const P1_deg = parseFloat(document.getElementById('phase1').value);
        const P1_rad = P1_deg * PI / 180; // Conversione da gradi a radianti

        // 2. Aggiorna i display dei valori
        document.getElementById('val-a1').textContent = A1.toFixed(0);
        document.getElementById('val-f1').textContent = F1.toFixed(1);
        document.getElementById('val-p1').textContent = P1_deg.toFixed(0) + '°';

        // 3. Cancella il canvas
        ctx1.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

        // 4. Disegna Onda 1
        drawWave(ctx1, A1, F1, P1_rad, '#3182ce'); // Blu
    }

    // Esegui la funzione al caricamento della pagina per disegnare le onde iniziali
    window.onload = function() {
        // Assegna la dimensione corretta ai canvas per la coerenza
        const canvases = document.querySelectorAll('canvas');
        canvases.forEach(c => {
            c.width = CANVAS_WIDTH;
            c.height = CANVAS_HEIGHT;
        });

        drawAll();
    };

</script>
</body>
</html>
